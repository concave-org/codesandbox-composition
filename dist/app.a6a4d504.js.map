{"version":3,"sources":["node_modules/@concave/concave/dist/concave.esm.js","src/renderfns/list.js","src/renderfns/listItem.js","src/components/todo.js","src/pipelines/todo.js","src/app.js"],"names":["actions","state","routeTo","routeBack","routeNew","pipelineChange","appendComponent","replaceComponent","setAttributes","mounted","rerender","html","literals","substitutions","String","raw","map","x","Array","isArray","join","replace","template","document","createElement","createComponent","renderFn","props","hooks","actionReducer","oldNode","action","dispatch","type","h","attrs","value","innerHTML","node","content","firstChild","renderAction","isEqualNode","toDispatch","push","createPipeline","fns","reduce","v","f","runPipeline","pipeline","callback","queue","corePipeline","actualPipeline","length","shift","pipe","Promise","resolve","createStore","stateReducer","initialState","window","history","replaceState","location","href","_route","route","JSON","parse","stringify","pushState","origin","RESOURCE_REGEX","createRouter","initialRoutes","currentRoute","currentQuery","routes","getRoute","path","search","query","searchParams","URLSearchParams","pair","entries","pathResources","match","preparedRoutes","filter","r","resources","calcPath","pr","idx","params","acc","cur","substring","changePipeline","pathname","fallbackRoute","find","fallback","matchedRoute","_module","default","addEventListener","event","scrollTo","createRenderer","parent","appendChild","id","selectionStart","selectionEnd","activeElement","replaceChild","el","getElementById","focus","setSelectionRange","removeChild","Object","keys","forEach","attr","startsWith","result","passive","setAttribute","render","items","text","next","item","onchange","target","add","onclick","todo","appStore","todoPipe","appRouter","appRender","corePipe"],"mappings":";;AKAA;;AAQA;;ALRA,MAAMA,OAAO,GAAG;AACdC,AGDF,ACAA,AHAA,ACAA,EFCEA,KAAK,EAAE,OADO;AAEdC,AKQF,ELREA,EKQI+I,KLRG,EAAE,CKQG,GAAG,KLVD,qBKUa,UAAChJ,KAAD,EAAQ8B,MAAR,EAAgBC,QAAhB,EAA6B;ALPxD7B,AKQA,AFTF,ACAA,EJCEA,QKSE4B,CLTO,EAAE,GKSH,CAACE,IADT,CAEA,ELbc;AAId7B,AKOA,ELPAA,QAAQ,EAAE,UAJI;AAKdC,AGFF,EHEEA,cAAc,EAAE,gBALF;AAMdC,AKUA,ELVAA,OKUOyB,MAAP,ELVe,EAAE,iBANH;AAOdxB,AKUD,CAPgB,CLHfA,AKGF,aDNe,GJGG,EAAE,kBAPJ,MIIcyI,aAAf;AJIbxI,AKWF,ELXEA,EKWIyE,MAAM,GAAG,CACb,CLZa,EAAE,eARD;AASdxE,AKWE0E,ELXF1E,AKWE0E,IAAI,EAAE,CLXD,EAAE,AKWT,SLpBc;AAUdzE,AKUagD,ELVbhD,AKUagD,IAAI,EAAE,ELVX,EAAE;AAVI,AKoBK,CLpBrB,UKoB2BwF,QAAN;AAAA;AAAnB,CADa,EAEb;ALRF,AKQIvC,EAAAA,ILREhG,IAAI,AKQE,EAAE,CLRD,CAACC,QAAD,EAAW,GAAGC,aAAd,KAAgC;AAC3C,AKOA,AJnBF,ACAA,CGiBe,CAAf,EJjBM0H,ACAAA,MDAM,ACAA,GDAG,ACAA,SDATA,ACAAA,MDAS,ACAA;AFab,AKSF,AJtBe,ACAA,IGsBTY,EJtBUX,ACAAC,GFaP3H,CEbM,CDAA,EIsBA,ELTA,CACVC,AKQa,GLTT,CACAH,QADA,EACU,GAAGC,UKQSoE,GLRI,CAACjE,EKQlB,CLRI,AKQtB,CLRwCC,CAAC,IAAIC,KAAK,CAACC,OAAN,CAAcF,CAAd,IAAmBA,CAAC,CAACG,IAAF,AEdzC,CFcgD,ACd/C,CCAT,CFciD,ACdjD,CDc8B,GAAgCH,CAAvD,CADb,EAEJI,OAFI,CAEI,QAFJ,EAEc,EAFd,CAAP;AAGD,AKQD,AJxBe,ACAA,CFWf,GKaM+H,SAAS,AJxBgBzI,ACADA,GGwBZ,UJxBH,ACAA,mBGwBkBY,EJtBzBiH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","file":"app.a6a4d504.js","sourceRoot":"..","sourcesContent":["const actions = {\n  state: 'state',\n  routeTo: 'routeTo',\n  routeBack: 'routeBack',\n  routeNew: 'routeNew',\n  pipelineChange: 'pipelineChange',\n  appendComponent: 'appendComponent',\n  replaceComponent: 'replaceComponent',\n  setAttributes: 'setAttributes',\n  mounted: 'mounted',\n  rerender: 'rerender'\n};\n\nconst html = (literals, ...substitutions) => {\n  // join arrays for easier usage in app e.g. list rendering\n  return String\n    .raw(literals, ...substitutions.map(x => Array.isArray(x) ? x.join('') : x))\n    .replace(/\\n\\s+/g, '')\n};\n\nconst template = document.createElement('template');\n\nconst createComponent = (renderFn, props = {}, hooks = {}, actionReducer) => {\n  let oldNode;\n\n  return (action, dispatch) => {\n    switch (action.type) {\n      case actions.state:\n        let { h, attrs } = renderFn(action.value, props);\n        template.innerHTML = h;\n        let node = template.content.firstChild;\n        let renderAction = !oldNode\n          ? actions.appendComponent\n          : !oldNode.isEqualNode(node)\n            ? actions.replaceComponent\n            : null;\n        if (renderAction) {\n          let toDispatch = [];\n          toDispatch.push({ type: renderAction, value: { node, oldNode } });\n          if (attrs) toDispatch.push({ type: actions.setAttributes, value: attrs });\n          dispatch(...toDispatch);\n          oldNode = node;\n        }\n        break\n      case actions.pipelineChange:\n        oldNode = null;\n        break\n      case actions.mounted:\n        if (hooks.mounted && oldNode === action.value) hooks.mounted(dispatch);\n        break\n    }\n    if (actionReducer) actionReducer(action, dispatch);\n    return action\n  }\n};\n\nconst createPipeline = (...fns) => (x, dispatch) => fns.reduce((v, f) => f(v, dispatch), x);\n\nconst runPipeline = pipeline => state => {\n  let callback;\n  const queue = [];\n  const corePipeline = pipeline;\n  let actualPipeline = pipeline;\n\n  const dispatch = (...actions) => {\n    if (callback) callback();\n    queue.push(...actions);\n  };\n\n  (async function () {\n    while (true) {\n      while (queue.length > 0) {\n        const action = queue.shift();\n        if (action.type === actions.pipelineChange) actualPipeline = createPipeline(corePipeline, action.value.pipe);\n        actualPipeline(action, dispatch);\n      }\n      await new Promise(resolve => { callback = resolve; });\n      callback = null;\n    }\n  }());\n  corePipeline({ type: actions.state, value: state }, dispatch);\n  return dispatch\n};\n\nconst createStore = stateReducer => {\n  let state;\n  let initialState;\n\n  return (action, dispatch) => {\n    switch (action.type) {\n      case actions.state:\n        if (!initialState) initialState = action.value;\n        state = action.value;\n        window.history.replaceState(state, null, document.location.href);\n        break\n      case actions.pipelineChange:\n        // needed to reset the state with a routeBack action\n        if (action.value.state) state = action.value.state;\n        state._route = action.value.route;\n        dispatch({ type: actions.state, value: JSON.parse(JSON.stringify(state)) });\n        break\n      case actions.routeTo:\n        state = initialState;\n        window.history.pushState(state, null, document.location.origin + action.value);\n        break\n      case actions.rerender:\n        dispatch({ type: actions.state, value: JSON.parse(JSON.stringify(state)) });\n    }\n    stateReducer(JSON.parse(JSON.stringify(state)), action, dispatch);\n    return action\n  }\n};\n\nconst RESOURCE_REGEX = /([^/]+)/g;\n\nconst createRouter = initialRoutes => {\n  let currentRoute;\n  let currentQuery;\n  let routes = initialRoutes;\n\n  const getRoute = (path, search) => {\n    const query = {};\n    const searchParams = new URLSearchParams(search);\n    for (const pair of searchParams.entries()) {\n      query[pair[0]] = pair[1];\n    }\n\n    const pathResources = path.match(RESOURCE_REGEX) || [];\n\n    const preparedRoutes = routes\n      .filter(r => r.path)\n      .map(r => ({ ...r, resources: r.path.match(RESOURCE_REGEX) || [] }))\n      .filter(r => r.resources.length === pathResources.length);\n\n    for (let route of preparedRoutes) {\n      let calcPath = pathResources\n        .map((pr, idx) =>\n          pr === route.resources[idx] ? `${pr}`\n            : route.resources[idx][0] === ':' ? `${route.resources[idx]}`\n              : '')\n        .join('/');\n      if (`/${calcPath}` === route.path) {\n        return {\n          ...route,\n          params: route.resources.reduce((acc, cur, idx) => cur !== pathResources[idx] ? { ...acc, [cur.substring(1)]: pathResources[idx] } : acc, {}),\n          query\n        }\n      }\n    }\n    return null\n  };\n\n  const changePipeline = async (dispatch, state) => {\n    const { pathname, search } = document.location;\n\n    const fallbackRoute = routes.find(r => r.fallback);\n    const matchedRoute = getRoute(pathname, search);\n\n    // only do anything when route or search params differ\n    if (currentRoute !== pathname || currentQuery !== search) {\n      // new route in defined routes?\n      if (matchedRoute) {\n        currentRoute = pathname;\n        currentQuery = search;\n\n        let _module = await matchedRoute.pipe();\n\n        dispatch({\n          type: actions.pipelineChange,\n          value: {\n            pipe: _module.default,\n            route: {\n              path: matchedRoute.path,\n              params: matchedRoute.params,\n              query: matchedRoute.query\n            },\n            state: state\n          }\n        });\n\n        // only dispatch route change if not already on fallback route\n      } else if (fallbackRoute && currentRoute !== fallbackRoute.fallback) {\n        currentRoute = fallbackRoute.fallback;\n        currentQuery = null;\n        dispatch({ type: actions.routeTo, value: fallbackRoute.fallback });\n      }\n    }\n  };\n\n  return (action, dispatch) => {\n    if (!currentRoute) {\n      window.addEventListener('popstate', event => dispatch({ type: actions.routeBack, value: event.state }));\n    }\n\n    switch (action.type) {\n      case actions.state:\n        if (!currentRoute) changePipeline(dispatch);\n        break\n      case actions.routeNew:\n        routes = [ ...routes, ...action.value ];\n        break\n      case actions.routeTo:\n        changePipeline(dispatch);\n        window.scrollTo(0, 0);\n        break\n      case actions.routeBack:\n        changePipeline(dispatch, action.value);\n        break\n    }\n\n    return action\n  }\n};\n\nconst createRenderer = parent => {\n  return (action, dispatch) => {\n    switch (action.type) {\n      case actions.appendComponent:\n        parent.appendChild(action.value.node);\n        // notify component\n        dispatch({ type: actions.mounted, value: action.value.node });\n        break\n      case actions.replaceComponent:\n        // get actual focused element\n        let { id, selectionStart, selectionEnd } = document.activeElement;\n        parent.replaceChild(action.value.node, action.value.oldNode);\n        // set focus on elements with value prop\n        if (id) {\n          let el = document.getElementById(id);\n          if (el.value || el.value === '') el.focus();\n          // set selection if set before\n          if (selectionStart && selectionEnd) el.setSelectionRange(selectionStart, selectionEnd);\n        }\n        break\n      case actions.pipelineChange:\n        while (parent.firstChild) parent.removeChild(parent.firstChild);\n        break\n      case actions.setAttributes:\n        Object.keys(action.value).forEach(id => {\n          let el = document.getElementById(id);\n          // only add event listener when element exists\n          if (el) {\n            Object.keys(action.value[id]).forEach(attr => {\n              let event = attr.startsWith('on') ? attr.substring(2) : null;\n              if (event && typeof action.value[id][attr] === 'function') {\n                el.addEventListener(event, event => {\n                  let result = action.value[id][attr](event, dispatch);\n                  if (typeof result === 'object') dispatch(result);\n                }, { passive: true });\n              } else el.setAttribute(attr, action.value[id][attr]);\n            });\n          }\n        });\n        break\n    }\n    return action\n  }\n};\n\nexport { actions, createComponent, createPipeline, createRenderer, createRouter, createStore, html, runPipeline };\n","import { html } from '@concave/concave'\n\nconst render = (items = []) => html`\n    <ul>\n      ${items}\n    </ul>\n  `\n\nexport default render\n","import { html } from '@concave/concave'\n\nconst render = (text = '') => html`\n    <li>${text}</li>\n  `\n\nexport default render\n","import { createComponent, html, actions } from '@concave/concave'\n\nimport list from '../renderfns/list'\nimport listItem from '../renderfns/listItem'\n\nconst props = {\n  items: ['Milk', 'Coffee', 'Sugar'],\n  next: ''\n}\n\nconst render = (state, props) => ({\n  h: html`\n    <main>\n      <article>\n        ${list(props.items.map(item => listItem(item)))}\n      </article>\n      <article>\n        <input id=\"next\" type=\"text\">\n        <button id=\"add\" style=\"margin-left: 1rem;\">add</button>\n      </article>\n    </main>\n  `,\n  attrs: {\n    next: {\n      onchange: event => {\n        props.next = event.target.value\n      }\n    },\n    add: {\n      onclick: (event, dispatch) => {\n        if (props.next !== '') {\n          props.items.push(props.next)\n          dispatch({ type: actions.rerender })\n        }\n      }\n    }\n  }\n})\n\nconst hooks = {\n  mounted: dispatch => {\n\n  }\n}\n\nexport default createComponent(render, props, hooks)\n","import { createPipeline } from '@concave/concave'\n\nimport todo from '../components/todo'\n\nexport default createPipeline(todo)\n","import {\n  runPipeline,\n  createStore,\n  createRouter,\n  createRenderer,\n  createPipeline\n} from '@concave/concave'\n\nimport * as todoPipe from './pipelines/todo'\n\nconst appStore = createStore((state, action, dispatch) => {\n  switch (\n    action.type\n  // ...dispatch state here with new state\n  ) {\n  }\n  return action\n})\n\nconst routes = [\n  { path: '/', pipe: () => todoPipe },\n  { fallback: '/' }\n]\n\nconst appRouter = createRouter(routes)\n\nconst appRender = createRenderer(document.getElementById('app'))\n\nconst corePipe = createPipeline(appStore, appRouter, appRender)\n\nconst initialState = {}\n\nrunPipeline(corePipe)(initialState)\n"]}